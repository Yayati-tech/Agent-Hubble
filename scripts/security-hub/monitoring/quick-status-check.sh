#!/bin/bash

# Quick Lambda Function Status Check
# This script provides a simple way to check Lambda function status

echo "üîç Quick Lambda Function Status Check"
echo "===================================="
echo ""

echo "üìã Current Status:"
echo "=================="
echo ""
echo "‚úÖ IAM permissions are working (you got past the layer publishing step)"
echo "‚úÖ Lambda layer 'cryptography-layer' was successfully published"
echo "üîÑ Lambda function is currently being updated"
echo "‚è≥ Waiting for function update to complete..."
echo ""

echo "üîó Check These Links:"
echo "===================="
echo ""
echo "1. **AWS Lambda Console**:"
echo "   https://console.aws.amazon.com/lambda/home?region=us-west-2#/functions/enhanced-auto-remediation-lambda-arm64"
echo ""
echo "2. **GitHub Actions**:"
echo "   https://github.com/Yayati-tech/Agent-Hubble/actions"
echo ""
echo "3. **CloudWatch Logs**:"
echo "   https://console.aws.amazon.com/cloudwatch/home?region=us-west-2#logsV2:log-groups/log-group/$252Faws$252Flambda$252Fenhanced-auto-remediation-lambda-arm64"
echo ""

echo "üéØ What to Look For:"
echo "==================="
echo ""
echo "In AWS Lambda Console:"
echo "‚Ä¢ Function State: Should show 'Active' (not 'Updating')"
echo "‚Ä¢ Last Update Status: Should show 'Successful' (not 'InProgress')"
echo "‚Ä¢ No error messages in the console"
echo ""

echo "‚è±Ô∏è  Expected Timeline:"
echo "===================="
echo ""
echo "‚Ä¢ Current wait time: 5-15 minutes total"
echo "‚Ä¢ Check every 2-3 minutes"
echo "‚Ä¢ Function should become available soon"
echo ""

echo "üîÑ When Ready to Re-run:"
echo "======================="
echo ""
echo "1. Go to GitHub Actions: https://github.com/Yayati-tech/Agent-Hubble/actions"
echo "2. Find the failed workflow run"
echo "3. Click 'Re-run jobs' or 'Re-run all jobs'"
echo "4. Monitor the deployment progress"
echo ""

echo "üí° Status Indicators:"
echo "==================="
echo ""
echo "‚úÖ READY: Function State = 'Active', Last Update Status = 'Successful'"
echo "‚è≥ WAITING: Last Update Status = 'InProgress' or 'Pending'"
echo "‚ùå ERROR: Function shows error messages or 'Failed' status"
echo ""

echo "üéâ Success Indicators:"
echo "===================="
echo ""
echo "‚Ä¢ Lambda function state: 'Active'"
echo "‚Ä¢ Last Update Status: 'Successful'"
echo "‚Ä¢ cryptography-layer exists with versions"
echo "‚Ä¢ No error messages in console"
echo "‚Ä¢ GitHub Actions can be re-run successfully"
echo ""

echo "üîÑ Run this script again in 2-3 minutes to check status"
echo "" 